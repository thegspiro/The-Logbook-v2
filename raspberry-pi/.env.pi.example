# The Logbook - Raspberry Pi Environment Configuration
# ======================================================
# Copy this file to .env and update with your settings
# Location: ~/The-Logbook-v2/.env

# ===========================================
# CRITICAL: Change these before first run!
# ===========================================

# Django Secret Key (generate with: openssl rand -base64 50)
DJANGO_SECRET_KEY=CHANGE_ME_GENERATE_A_RANDOM_SECRET_KEY_HERE

# PostgreSQL Database Password (generate with: openssl rand -base64 32)
POSTGRES_PASSWORD=CHANGE_ME_GENERATE_A_STRONG_PASSWORD_HERE

# ===========================================
# Network & Access Configuration
# ===========================================

# Raspberry Pi IP address or hostname (comma-separated for multiple)
# Find your Pi's IP with: hostname -I
# Examples: 192.168.1.100,logbook.local,mydomain.com
DJANGO_ALLOWED_HOSTS=*

# Port Configuration (change if ports are already in use)
HTTP_PORT=80
HTTPS_PORT=443
APP_PORT=8000

# ===========================================
# Database Configuration
# ===========================================

POSTGRES_DB=logbook_db
POSTGRES_USER=logbook_user
# POSTGRES_PASSWORD is set above

# ===========================================
# Application Settings
# ===========================================

# Your fire department name
APP_NAME=The Logbook

# Organization name (shown in onboarding)
ORGANIZATION_NAME=Volunteer Fire Company 1

# Theme Colors (hex codes)
PRIMARY_COLOR=#DC2626
SECONDARY_COLOR=#1F2937

# Timezone (see: https://en.wikipedia.org/wiki/List_of_tz_database_time_zones)
TZ=America/New_York

# Debug Mode (NEVER set to True in production!)
DJANGO_DEBUG=False

# ===========================================
# Raspberry Pi Model Configuration
# ===========================================
# Choose settings based on your Raspberry Pi model
# Uncomment the section for YOUR model

# --- Raspberry Pi 5 (8GB) ---
# Best performance, handles 50+ users
# DB_MEMORY_LIMIT=2048m
# APP_MEMORY_LIMIT=2048m
# NGINX_MEMORY_LIMIT=256m
# GUNICORN_WORKERS=6
# GUNICORN_THREADS=2
# PG_SHARED_BUFFERS=2GB
# PG_CACHE_SIZE=6GB
# PG_WORK_MEM=64MB
# PG_MAINT_WORK_MEM=512MB
# PG_MAX_CONNECTIONS=50
# PG_SHM_SIZE=512mb

# --- Raspberry Pi 4 (4GB) ---
# Good performance, handles 20-50 users
DB_MEMORY_LIMIT=1024m
APP_MEMORY_LIMIT=1024m
NGINX_MEMORY_LIMIT=128m
GUNICORN_WORKERS=4
GUNICORN_THREADS=2
PG_SHARED_BUFFERS=1GB
PG_CACHE_SIZE=3GB
PG_WORK_MEM=32MB
PG_MAINT_WORK_MEM=256MB
PG_MAX_CONNECTIONS=30
PG_SHM_SIZE=256mb

# --- Raspberry Pi 4 (2GB) ---
# Adequate performance, handles 10-20 users
# IMPORTANT: Enable 2GB+ swap for stability
# DB_MEMORY_LIMIT=512m
# APP_MEMORY_LIMIT=512m
# NGINX_MEMORY_LIMIT=128m
# GUNICORN_WORKERS=2
# GUNICORN_THREADS=2
# PG_SHARED_BUFFERS=256MB
# PG_CACHE_SIZE=1GB
# PG_WORK_MEM=16MB
# PG_MAINT_WORK_MEM=128MB
# PG_MAX_CONNECTIONS=20
# PG_SHM_SIZE=256mb

# --- Raspberry Pi 3B+ (1GB) ---
# Limited performance, handles <10 users
# IMPORTANT: Enable 4GB swap for stability
# DB_MEMORY_LIMIT=256m
# APP_MEMORY_LIMIT=256m
# NGINX_MEMORY_LIMIT=64m
# GUNICORN_WORKERS=2
# GUNICORN_THREADS=1
# PG_SHARED_BUFFERS=128MB
# PG_CACHE_SIZE=512MB
# PG_WORK_MEM=8MB
# PG_MAINT_WORK_MEM=64MB
# PG_MAX_CONNECTIONS=10
# PG_SHM_SIZE=128mb

# ===========================================
# Storage Configuration
# ===========================================

# Default storage backend (local or s3)
# For Raspberry Pi, 'local' is recommended
DEFAULT_STORAGE_BACKEND=local

# AWS S3 Configuration (only needed if using S3)
# AWS_ACCESS_KEY_ID=
# AWS_SECRET_ACCESS_KEY=
# AWS_STORAGE_BUCKET_NAME=
# AWS_S3_REGION_NAME=us-east-1

# ===========================================
# Email Configuration (configure in onboarding)
# ===========================================

# EMAIL_BACKEND=django.core.mail.backends.smtp.EmailBackend
# EMAIL_HOST=smtp.gmail.com
# EMAIL_PORT=587
# EMAIL_USE_TLS=True
# EMAIL_HOST_USER=your-email@gmail.com
# EMAIL_HOST_PASSWORD=your-app-password
# EMAIL_FROM=noreply@yourfiredept.org

# ===========================================
# Security Settings (configure in onboarding)
# ===========================================

# SESSION_COOKIE_SECURE=True  # Enable for HTTPS
# CSRF_COOKIE_SECURE=True     # Enable for HTTPS
# SESSION_TIMEOUT_MINUTES=60
# PASSWORD_MIN_LENGTH=12
# REQUIRE_2FA=False

# ===========================================
# Raspberry Pi Specific Settings
# ===========================================

# Gunicorn Timeout (increase for slower Pis)
GUNICORN_TIMEOUT=120

# Backup Location
BACKUP_DIR=/home/pi/backups/logbook

# Backup Retention (days)
RETENTION_DAYS=30

# ===========================================
# Advanced Settings
# ===========================================

# Max upload size (in MB) - reduce for low RAM Pis
MAX_UPLOAD_SIZE=50

# Log Level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=INFO

# ===========================================
# Performance Tips for Raspberry Pi
# ===========================================
#
# 1. Use SSD instead of SD card (5-10x faster)
# 2. Enable swap for low-RAM models:
#    sudo nano /etc/dphys-swapfile
#    CONF_SWAPSIZE=2048  # or 4096 for 1GB Pi
#
# 3. Monitor temperature:
#    vcgencmd measure_temp
#    Should stay below 80Â°C
#
# 4. Use wired ethernet (more stable than WiFi)
#
# 5. Use quality power supply (official recommended)
#
# 6. Add heatsink or fan to prevent thermal throttling
#
# 7. Reduce logging to save storage wear:
#    Already configured in docker-compose.pi.yml
#
# 8. Monitor resources:
#    htop
#    docker stats
#    free -h
#    df -h
